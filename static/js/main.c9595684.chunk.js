(this["webpackJsonpreact-typescript-starter-pack"]=this["webpackJsonpreact-typescript-starter-pack"]||[]).push([[0],{22:function(t,e,n){},26:function(t,e,n){"use strict";n.r(e);var o=n(1),c=n(5),a=(n(20),n(21),n(22),n(9)),r=n(2),i=n(3),s=n.n(i),l="https://mate.academy/students-api";function u(t){return new Promise((function(e){setTimeout(e,t)}))}function d(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o={method:e};return n&&(o.body=JSON.stringify(n),o.headers={"Content-Type":"application/json; charset=UTF-8"}),u(300).then((function(){return fetch(l+t,o)})).then((function(t){if(!t.ok)throw new Error;return t.json()}))}var f,j=function(t){return d(t)},b=function(t,e){return d(t,"POST",e)},m=function(t,e){return d(t,"PATCH",e)},O=function(t){return d(t,"DELETE")},h=n(0),p=function(t){var e=t.setUser,n=t.showError,c=Object(o.useState)(""),a=Object(r.a)(c,2),i=a[0],s=a[1];return Object(h.jsxs)("form",{className:"box mt-5",onSubmit:function(t){t.preventDefault(),function(t){return b("/users",{email:t})}(i).then((function(t){s(""),e(t),localStorage.setItem("user",JSON.stringify(t))})).catch((function(){return n("Something wrong, try again later")}))},children:[Object(h.jsx)("h1",{className:"title is-3",children:"Log in to open todos"}),Object(h.jsxs)("div",{className:"field",children:[Object(h.jsx)("label",{className:"label",htmlFor:"user-email",children:"Email"}),Object(h.jsxs)("div",{className:"control has-icons-left",children:[Object(h.jsx)("input",{type:"email",id:"user-email",className:"input",placeholder:"Enter your email",required:!0,value:i,onChange:function(t){return s(t.target.value)}}),Object(h.jsx)("span",{className:"icon is-small is-left",children:Object(h.jsx)("i",{className:"fas fa-envelope"})})]})]}),Object(h.jsx)("div",{className:"field",children:Object(h.jsx)("button",{type:"submit",className:"button is-primary",children:"Login"})})]})},v=n(4),x=function(t){var e=t.filteredTodosCount,n=t.todos,c=t.createTodo,a=t.changeTodo,i=t.setError,l=Object(o.useState)(""),u=Object(r.a)(l,2),d=u[0],f=u[1],j=Object(o.useState)(!1),b=Object(r.a)(j,2),m=b[0],O=b[1];return Object(h.jsxs)("header",{className:"todoapp__header",children:[!!e&&Object(h.jsx)("button",{type:"button","aria-label":"Toggle all Todo selected",className:s()("todoapp__toggle-all",{active:n.every((function(t){return t.completed}))}),onClick:function(){var t=n.some((function(t){return!t.completed}));n.forEach((function(e){e.completed!==t&&a(Object(v.a)(Object(v.a)({},e),{},{completed:t}))}))}}),Object(h.jsx)("form",{onSubmit:function(t){t.preventDefault(),O(!0);var e=d.trim();if(!e)return i("Title can't be empty"),O(!1),void f("");c(e).finally((function(){O(!1),f("")}))},children:Object(h.jsx)("input",{type:"text",className:"todoapp__new-todo",placeholder:"What needs to be done?",disabled:m,value:d,onChange:function(t){return f(t.target.value)}})})]})};!function(t){t.all="All",t.active="Active",t.completed="Completed"}(f||(f={}));var g=function(t){var e=t.status,n=t.onChangeStatus,o=t.todos,c=t.deleteTodo,a=o.reduce((function(t,e){return t+ +!e.completed}),0),r=o.some((function(t){return!0===t.completed}));return Object(h.jsxs)("footer",{className:"todoapp__footer",children:[Object(h.jsx)("span",{className:"todo-count",children:"".concat(a," items left")}),Object(h.jsx)("nav",{className:"filter",children:Object.values(f).map((function(t){return Object(h.jsx)("a",{href:t!==f.all?"#/".concat(t.toLowerCase()):"#/",className:s()("filter__link",{selected:e===t}),onClick:function(){return n(t)},children:t},t)}))}),Object(h.jsx)("button",{type:"button",className:s()("todoapp__clear-completed",{hidden:!r}),onClick:function(){o.filter((function(t){return t.completed})).forEach((function(t){return c(t.id)}))},children:"Clear completed"})]})},N=n(29),y=n(28),T=function(t){var e=t.todo,n=t.todosIdInLoading,c=void 0===n?[0]:n,a=t.changeTodo,i=void 0===a?function(){}:a,l=t.deleteTodo,u=void 0===l?function(){}:l,d=e.id,f=e.title,j=e.completed,b=Object(o.useState)(!1),m=Object(r.a)(b,2),O=m[0],p=m[1],x=Object(o.useState)(!1),g=Object(r.a)(x,2),N=g[0],y=g[1],T=Object(o.useState)(f),_=Object(r.a)(T,2),S=_[0],E=_[1],C=Object(o.useRef)(null);Object(o.useEffect)((function(){p(c.includes(d))}),[c]),Object(o.useEffect)((function(){C.current&&N&&C.current.focus()}),[N]);var k=function(){var t=S.trim();t||u(d),t&&t!==f&&(i(Object(v.a)(Object(v.a)({},e),{},{title:t})),E(t)),y(!1)};return Object(h.jsxs)("div",{className:s()("todo",{completed:j}),children:[Object(h.jsx)("label",{className:"todo__status-label",children:Object(h.jsx)("input",{type:"checkbox",className:"todo__status",onChange:function(){i(Object(v.a)(Object(v.a)({},e),{},{completed:!j}))}})}),!N&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("span",{className:"todo__title",onDoubleClick:function(){return y(!0)},children:f}),Object(h.jsx)("button",{type:"button",className:"todo__remove",onClick:function(){return u(e.id)},children:"\xd7"})]}),N&&Object(h.jsx)("form",{children:Object(h.jsx)("input",{type:"text",ref:C,className:"todo__title-field",placeholder:"Empty todo will be deleted",value:S,onChange:function(t){return E(t.target.value)},onBlur:k,onKeyDown:function(t){"Escape"===t.key&&(E(f),y(!1)),"Enter"===t.key&&k()}})}),Object(h.jsxs)("div",{className:s()("modal overlay",{"is-active":O}),children:[Object(h.jsx)("div",{className:"modal-background has-background-white-ter"}),Object(h.jsx)("div",{className:"loader"})]})]})},_=function(t){var e=t.todos,n=t.tempTodo,o=t.changeTodo,c=t.todosIdInLoading,a=t.deleteTodo;return Object(h.jsx)("section",{className:"todoapp__main","data-cy":"TodoList",children:Object(h.jsxs)(N.a,{children:[e.map((function(t){return Object(h.jsx)(y.a,{timeout:300,classNames:"item",children:Object(h.jsx)(T,{todo:t,todosIdInLoading:c,changeTodo:o,deleteTodo:a})},t.id)})),n&&Object(h.jsx)(y.a,{timeout:300,classNames:"temp-item",children:Object(h.jsx)(T,{todo:n})},0)]})})};var S=function(){var t=Object(o.useState)(function(){var t=localStorage.getItem("user"),e={id:0};if(null===t)return e;try{return JSON.parse(t)}catch(n){return e}}()),e=Object(r.a)(t,2),n=e[0],c=e[1],i=Object(o.useState)([]),l=Object(r.a)(i,2),u=l[0],d=l[1],v=Object(o.useState)([]),N=Object(r.a)(v,2),y=N[0],T=N[1],S=Object(o.useState)(null),E=Object(r.a)(S,2),C=E[0],k=E[1],w=Object(o.useState)(""),I=Object(r.a)(w,2),L=I[0],U=I[1],D=Object(o.useState)(f.all),J=Object(r.a)(D,2),A=J[0],F=J[1],P=Object(o.useState)([]),B=Object(r.a)(P,2),q=B[0],G=B[1],H=function(t){U(t);var e=setTimeout((function(){return U("")}),3e3);return function(){return clearTimeout(e)}};Object(o.useEffect)((function(){var t;n.id&&(t=n.id,j("/todos?userId=".concat(t))).then(d).catch((function(){return H("Unable to load a todos")}))}),[n]);var K=function(t){G((function(e){return[].concat(Object(a.a)(e),[t.id])})),function(t){var e=t.id,n=t.title,o=t.completed;return m("/todos/".concat(e),{title:n,completed:o})}(t).then((function(t){d((function(e){return e.map((function(e){return e.id===t.id?t:e}))}))})).catch((function(){H("Unable to update a todos")})).finally((function(){return G((function(e){return e.filter((function(e){return e!==t.id}))}))}))},R=function(t){G((function(e){return[].concat(Object(a.a)(e),[t])})),function(t){return O("/todos/".concat(t))}(t).then((function(){d((function(e){return e.filter((function(e){return e.id!==t}))}))})).catch((function(){H("Unable to delete a todos")})).finally((function(){return G((function(e){return e.filter((function(e){return e!==t}))}))}))};return Object(o.useEffect)((function(){switch(A){case f.active:T(u.filter((function(t){return!1===t.completed})));break;case f.completed:T(u.filter((function(t){return!0===t.completed})));break;case f.all:default:T(Object(a.a)(u))}}),[A,u]),Object(h.jsxs)("div",{className:"todoapp",children:[Object(h.jsx)("h1",{className:"todoapp__title",children:"todos"}),!n.id&&Object(h.jsx)(p,{setUser:c,showError:H}),!!n.id&&Object(h.jsxs)("div",{className:"todoapp__content",children:[Object(h.jsx)(x,{filteredTodosCount:y.length,todos:u,createTodo:function(t){var e,o;return k({id:0,userId:n.id,title:t,completed:!1}),G((function(t){return[].concat(Object(a.a)(t),[0])})),(e=n.id,o=t,b("/todos",{userId:e,title:o,completed:!1})).then((function(t){d((function(e){return[].concat(Object(a.a)(e),[t])}))})).catch((function(){H("Unable to add a todos")})).finally((function(){k(null),G((function(t){return t.filter((function(t){return 0!==t}))}))}))},changeTodo:K,setError:H}),Object(h.jsx)(_,{todos:y,tempTodo:C,changeTodo:K,todosIdInLoading:q,deleteTodo:R}),!!u.length&&Object(h.jsx)(g,{status:A,onChangeStatus:F,todos:u,deleteTodo:R})]}),Object(h.jsxs)("div",{className:s()("notification is-danger is-light has-text-weight-normal",{hidden:!L}),children:[Object(h.jsx)("button",{type:"button","aria-label":"Close error message",className:"delete",onClick:function(){return U("")}}),L]})]})},E=document.getElementById("root");Object(c.render)(Object(h.jsx)(S,{}),E)}},[[26,1,2]]]);
//# sourceMappingURL=main.c9595684.chunk.js.map